"use strict";var c=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var P=(e,n)=>{for(var s in n)c(e,s,{get:n[s],enumerable:!0})},O=(e,n,s,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of y(n))!w.call(e,i)&&i!==s&&c(e,i,{get:()=>n[i],enumerable:!(t=T(n,i))||t.enumerable});return e};var C=e=>O(c({},"__esModule",{value:!0}),e);var M={};P(M,{default:()=>E});module.exports=C(M);var r=require("@raycast/api");var l=require("@raycast/api");var u=require("fs"),g=require("path");var m=e=>(e.d1=e.d1=="----"?void 0:e.d1,e.d2=e.d2=="----"?void 0:e.d2,Math.round((e.d1?new Date(e.d1):new Date).getTime()-(e.d2?new Date(e.d2):new Date).getTime())/1e3);var a=require("@raycast/api");var L=l.environment.supportPath+"/customTimers.json",x=l.environment.supportPath+"/defaultPresetVisibles.json",p=e=>{try{(0,u.unlinkSync)(e)}catch(n){if(n instanceof Error&&!n.message.includes("ENOENT"))throw n}};function S(e){let n=l.environment.supportPath+"/"+e,s=n.replace(".timer",".dismiss");p(n),p(s)}function h(){let e=[];return(0,u.readdirSync)(l.environment.supportPath).forEach(s=>{if((0,g.extname)(s)==".timer"){let t={name:"",secondsSet:-99,timeLeft:-99,originalFile:s,timeEnds:new Date,pid:void 0,lastPaused:"---",pauseElapsed:0,selectedSound:"default"},i=(0,u.readFileSync)(l.environment.supportPath+"/"+s).toString();try{let o=JSON.parse(i);t.name=o.name,t.pid=o.pid,t.lastPaused=o.lastPaused,t.pauseElapsed=o.pauseElapsed,t.selectedSound=o.selectedSound}catch(o){if(!(o instanceof SyntaxError))throw o;t.name=i}let d=s.split("---");t.secondsSet=Number(d[1].split(".")[0]);let f=d[0].replace(/__/g,":");t.timeEnds=new Date(f),t.timeEnds.setSeconds(t.timeEnds.getSeconds()+t.secondsSet+t.pauseElapsed),t.timeLeft=Math.max(0,Math.round(t.pid===void 0?t.secondsSet-m({d1:t.lastPaused==="---"?void 0:t.lastPaused,d2:new Date(f)})+t.pauseElapsed:m({d1:t.timeEnds}))),e.push(t)}}),e.sort((s,t)=>s.timeLeft-t.timeLeft),e}var E=async()=>{if(!(0,r.getPreferenceValues)().ringContinuously)return await(0,r.showToast)({style:r.Toast.Style.Failure,title:"Ring Continuously setting not enabled!"});let e=h().filter(n=>n.timeLeft===0);if(e.length===0)return await(0,r.showToast)({style:r.Toast.Style.Failure,title:"No finished timers found!"});await(0,r.closeMainWindow)(),S(e[0].originalFile)};
