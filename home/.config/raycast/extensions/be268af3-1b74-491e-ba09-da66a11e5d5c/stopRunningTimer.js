"use strict";var l=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var P=(e,n)=>{for(var s in n)l(e,s,{get:n[s],enumerable:!0})},O=(e,n,s,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of w(n))!y.call(e,r)&&r!==s&&l(e,r,{get:()=>n[r],enumerable:!(t=T(n,r))||t.enumerable});return e};var E=e=>O(l({},"__esModule",{value:!0}),e);var C={};P(C,{default:()=>M});module.exports=E(C);var u=require("@raycast/api");var c=require("@raycast/api");var a=require("fs"),g=require("path");var m=e=>(e.d1=e.d1=="----"?void 0:e.d1,e.d2=e.d2=="----"?void 0:e.d2,Math.round((e.d1?new Date(e.d1):new Date).getTime()-(e.d2?new Date(e.d2):new Date).getTime())/1e3);var o=require("@raycast/api");var L=c.environment.supportPath+"/customTimers.json",x=c.environment.supportPath+"/defaultPresetVisibles.json",p=e=>{try{(0,a.unlinkSync)(e)}catch(n){if(n instanceof Error&&!n.message.includes("ENOENT"))throw n}};function S(e){let n=c.environment.supportPath+"/"+e,s=n.replace(".timer",".dismiss");p(n),p(s)}function h(){let e=[];return(0,a.readdirSync)(c.environment.supportPath).forEach(s=>{if((0,g.extname)(s)==".timer"){let t={name:"",secondsSet:-99,timeLeft:-99,originalFile:s,timeEnds:new Date,pid:void 0,lastPaused:"---",pauseElapsed:0,selectedSound:"default"},r=(0,a.readFileSync)(c.environment.supportPath+"/"+s).toString();try{let i=JSON.parse(r);t.name=i.name,t.pid=i.pid,t.lastPaused=i.lastPaused,t.pauseElapsed=i.pauseElapsed,t.selectedSound=i.selectedSound}catch(i){if(!(i instanceof SyntaxError))throw i;t.name=r}let d=s.split("---");t.secondsSet=Number(d[1].split(".")[0]);let f=d[0].replace(/__/g,":");t.timeEnds=new Date(f),t.timeEnds.setSeconds(t.timeEnds.getSeconds()+t.secondsSet+t.pauseElapsed),t.timeLeft=Math.max(0,Math.round(t.pid===void 0?t.secondsSet-m({d1:t.lastPaused==="---"?void 0:t.lastPaused,d2:new Date(f)})+t.pauseElapsed:m({d1:t.timeEnds}))),e.push(t)}}),e.sort((s,t)=>s.timeLeft-t.timeLeft),e}var M=async()=>{let e=h();if(e.length===0)return await(0,u.showToast)({style:u.Toast.Style.Failure,title:"No timers found!"});S(e[0].originalFile),await(0,u.closeMainWindow)(),(0,u.showHUD)(`Timer "${e[0].name}" stopped!`)};
